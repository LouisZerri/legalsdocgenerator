{% extends 'layout/app.html.twig' %}

{% block title %}Documents - Legal Docs Generator
{% endblock %}
{% block page_title %}Documents
{% endblock %}

{% block content %}
	<div class="mb-6 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
		<div>
			<p class="text-gray-600">{{ documents|length }}
				document(s)</p>
		</div>

		<div
			class="flex items-center gap-4">
			<!-- Filtres par statut -->
			<div class="flex items-center gap-2">
				<a href="{{ path('app_document_index') }}" class="px-3 py-1.5 text-sm rounded-full {{ currentStatus is null ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200' }} transition">
					Tous
				</a>
				<a href="{{ path('app_document_index') }}?status=draft" class="px-3 py-1.5 text-sm rounded-full {{ currentStatus == 'draft' ? 'bg-gray-600 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200' }} transition">
					Brouillons
				</a>
				<a href="{{ path('app_document_index') }}?status=review" class="px-3 py-1.5 text-sm rounded-full {{ currentStatus == 'review' ? 'bg-yellow-500 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200' }} transition">
					En revue
				</a>
				<a href="{{ path('app_document_index') }}?status=approved" class="px-3 py-1.5 text-sm rounded-full {{ currentStatus == 'approved' ? 'bg-green-600 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200' }} transition">
					Approuvés
				</a>
				<a href="{{ path('app_document_index') }}?status=signed" class="px-3 py-1.5 text-sm rounded-full {{ currentStatus == 'signed' ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200' }} transition">
					Signés
				</a>
			</div>

			<a href="{{ path('app_template_index') }}" class="bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition">
				+ Nouveau document
			</a>
		</div>
	</div>

	{% if documents|length > 0 %}
		<div class="bg-white rounded-lg shadow overflow-hidden">
			<table class="min-w-full divide-y divide-gray-200">
				<thead class="bg-gray-50">
					<tr>
						<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Document</th>
						<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Template</th>
						<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Statut</th>
						<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Créé par</th>
						<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Date</th>
						<th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">Actions</th>
					</tr>
				</thead>
				<tbody class="bg-white divide-y divide-gray-200">
					{% for document in documents %}
						<tr class="hover:bg-gray-50">
							<td class="px-6 py-4">
								<a href="{{ path('app_document_show', {id: document.id}) }}" class="text-indigo-600 hover:text-indigo-900 font-medium">
									Document #{{ document.id }}
								</a>
							</td>
							<td class="px-6 py-4 text-sm text-gray-600">
								{{ document.template.name }}
							</td>
							<td class="px-6 py-4">
								{% set statusColors = {
                        'draft': 'bg-gray-100 text-gray-800',
                        'review': 'bg-yellow-100 text-yellow-800',
                        'approved': 'bg-green-100 text-green-800',
                        'signed': 'bg-blue-100 text-blue-800',
                        'archived': 'bg-purple-100 text-purple-800'
                    } %}
								{% set statusLabels = {
                        'draft': 'Brouillon',
                        'review': 'En revue',
                        'approved': 'Approuvé',
                        'signed': 'Signé',
                        'archived': 'Archivé'
                    } %}
								<span class="px-2 py-1 text-xs rounded-full {{ statusColors[document.status] }}">
									{{ statusLabels[document.status] }}
								</span>
							</td>
							<td class="px-6 py-4 text-sm text-gray-600">
								{{ document.createdBy.name }}
							</td>
							<td class="px-6 py-4 text-sm text-gray-600">
								{{ document.createdAt|date('d/m/Y H:i') }}
							</td>
							<td class="px-6 py-4 text-right">
								<a href="{{ path('app_document_show', {id: document.id}) }}" class="text-indigo-600 hover:text-indigo-900 text-sm">
									Voir
								</a>
							</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	{% else %}
		<div class="text-center py-12 bg-white rounded-lg shadow">
			<p class="text-gray-500 mb-4">
				{% if currentStatus %}
					Aucun document avec le statut "{{ currentStatus }}".
				{% else %}
					Aucun document créé.
				{% endif %}
			</p>
			<a href="{{ path('app_template_index') }}" class="text-indigo-600 hover:text-indigo-900">
				Choisir un template pour commencer
			</a>
		</div>
	{% endif %}
{% endblock %}
